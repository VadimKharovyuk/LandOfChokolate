<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Пошук товарів - Шоколадна країна</title>
  <meta name="description" content="Знайдіть ваші улюблені товари швидко та легко">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" th:href="@{/css/fragment/navigation.css}">
  <link rel="stylesheet" th:href="@{/css/fragment/mobile-bottom-nav.css}">
  <link rel="stylesheet" th:href="@{/css/search/searchPage.css}">

</head>

<body>
<!-- Навигация -->
<div th:insert="~{admin/fragments/navigation :: navigation}"></div>

<!-- Основной контент -->
<div class="main-content">
  <div class="main-container">
    <div class="search-container">
      <!-- Hero Section -->
      <div class="search-hero">
        <h1 class="search-title">
          <i class="fas fa-search"></i>
          Пошук товарів
        </h1>
        <p class="search-subtitle">Відкрийте для себе світ преміальних товарів з елегантним пошуком</p>
      </div>

      <!-- Premium Search Form -->
      <div class="premium-search-form">
        <form method="GET" th:action="@{/search}">
          <div class="search-input-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text"
                   name="searchTerm"
                   class="premium-search-input"
                   th:value="${param.searchTerm}"
                   placeholder="Введіть назву товару..."
                   autocomplete="off"
                   autofocus>
            <button type="submit" class="premium-search-btn">
              <i class="fas fa-arrow-right"></i>
              Знайти
            </button>
          </div>
        </form>
      </div>

      <!-- Results Section -->
      <div class="results-section" th:if="${param.searchTerm}">

        <!-- Results Header -->
        <div class="results-header" th:if="${productListDtos != null}">
          <h2 class="results-title">Результати пошуку</h2>
          <div class="results-count">
            <i class="fas fa-tag" style="margin-right: 8px; color: #d4a574;"></i>
            Знайдено: [[${#lists.size(productListDtos)}]] товар(ів)
            <span th:if="${param.searchTerm}">
              за запитом "<strong>[[${param.searchTerm}]]</strong>"
            </span>
          </div>
        </div>

        <!-- Premium Products Grid -->
        <div class="premium-products-grid" th:if="${productListDtos != null and #lists.size(productListDtos) > 0}">
          <a th:each="product : ${productListDtos}"
             th:href="@{'/product/' + ${product.slug}}"
             class="premium-product-card animate-luxury">

            <!-- Product Image -->
            <img th:src="${product.imageUrl}"
                 th:alt="${product.name}"
                 class="premium-product-image"
                 onerror="this.src='/images/no-image.jpg'">

            <!-- Product Info -->
            <div class="premium-product-info">
              <!-- Category -->
              <div class="premium-product-category" th:text="${product.categoryName}">Категорія</div>

              <!-- Name -->
              <h3 class="premium-product-name" th:text="${product.name}">Назва товару</h3>

              <!-- Brand -->
              <div class="premium-product-brand" th:if="${product.brandName}" th:text="${product.brandName}">Бренд</div>

              <!-- Price -->
              <div class="premium-product-price" th:text="${product.price} + ' грн'">0 грн</div>

              <!-- Stock Status -->
              <div class="premium-product-stock">
                <span class="premium-stock-status"
                      th:classappend="${product.inStock ? (product.lowStock ? 'premium-stock-low' : 'premium-stock-in') : 'premium-stock-out'}">
                  <i class="fas"
                     th:classappend="${product.inStock ? (product.lowStock ? 'fa-exclamation-triangle' : 'fa-check') : 'fa-times'}"
                     style="margin-right: 5px;"></i>
                  <span th:text="${product.inStock ? (product.lowStock ? 'Мало' : 'В наявності') : 'Немає'}">Статус</span>
                </span>


              </div>
            </div>
          </a>
        </div>

        <!-- Empty Results -->
        <div class="premium-no-results" th:if="${productListDtos != null and #lists.size(productListDtos) == 0}">
          <div class="premium-no-results-icon">
            <i class="fas fa-search-minus"></i>
          </div>
          <h3 class="premium-no-results-title">Нічого не знайдено</h3>
          <p class="premium-no-results-text">
            За запитом "<strong>[[${param.searchTerm}]]</strong>" товари не знайдені.<br>
            Спробуйте змінити пошуковий запит або перевірте правопис.
          </p>
        </div>
      </div>

      <!-- Welcome State -->
      <div class="premium-no-results" th:unless="${param.searchTerm}">
        <div class="premium-no-results-icon">
          <i class="fas fa-compass"></i>
        </div>
        <h3 class="premium-no-results-title">Розпочніть пошук</h3>
        <p class="premium-no-results-text">
          Введіть назву товару в поле вище, щоб знайти потрібні вам товари.<br>
          <em>Наприклад: "шоколад", "цукерки", "тортики"</em>
        </p>
      </div>
    </div>
  </div>
</div>

<!-- JavaScript библиотеки -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/scrollTopButton.js}"></script>

<!-- Мобильная навигация снизу  -->
<div th:replace="~{admin/fragments/mobile-bottom-nav :: mobile-bottom-navigation}"></div>
<script th:replace="~{admin/fragments/mobile-bottom-nav :: mobile-bottom-navigation-script}"></script>

<!-- JavaScript -->
<script th:replace="~{admin/fragments/navigation :: navigation-script}"></script>

<!-- Enhanced UX JavaScript -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.querySelector('.premium-search-input');
    const searchForm = document.querySelector('form');
    const searchBtn = document.querySelector('.premium-search-btn');

    // Auto-focus on desktop
    if (searchInput && window.innerWidth > 768) {
      searchInput.focus();
    }

    // Enhanced search button animation
    if (searchBtn) {
      searchBtn.addEventListener('click', function() {
        if (searchInput.value.trim()) {
          this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
          this.style.background = 'linear-gradient(135deg, #b8944a, #a8874a)';
        }
      });
    }

    // Smooth form interactions
    if (searchInput) {
      searchInput.addEventListener('focus', function() {
        this.parentElement.style.transform = 'scale(1.02)';
      });

      searchInput.addEventListener('blur', function() {
        this.parentElement.style.transform = 'scale(1)';
      });

      searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          searchForm.submit();
        }
      });
    }

    // Staggered animation for product cards
    const productCards = document.querySelectorAll('.premium-product-card');
    productCards.forEach((card, index) => {
      card.style.animationDelay = `${index * 0.1}s`;
    });

    // Intersection Observer for scroll animations
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, { threshold: 0.1 });

    productCards.forEach(card => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(30px)';
      card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
      observer.observe(card);
    });

    // Add subtle parallax effect to hero
    window.addEventListener('scroll', () => {
      const scrolled = window.pageYOffset;
      const hero = document.querySelector('.search-hero');
      if (hero) {
        hero.style.transform = `translateY(${scrolled * 0.1}px)`;
      }
    });
  });
</script>
</body>
</html>
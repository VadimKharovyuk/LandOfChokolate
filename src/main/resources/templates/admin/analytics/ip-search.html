<!DOCTYPE html>
<html lang="uk" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–∏—Å–∫ –ø–æ IP - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</title>
</head>
<body>

<h1>–ü–æ–∏—Å–∫ –ø–æ IP –∞–¥—Ä–µ—Å—É</h1>

<!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
<p>
    <a href="/analytics">‚Üê –ù–∞–∑–∞–¥ –∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ</a> |
    <a href="/analytics/countries">–°—Ç—Ä–∞–Ω—ã</a> |
    <a href="/analytics/top-ips">–¢–æ–ø IP</a>
</p>

<hr>

<!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
<h2>–ü–æ–∏—Å–∫ –ø–æ—Å–µ—â–µ–Ω–∏–π –ø–æ IP</h2>
<form method="get" action="/analytics/ip">
    <label for="ip">–í–≤–µ–¥–∏—Ç–µ IP –∞–¥—Ä–µ—Å:</label>
    <input type="text"
           id="ip"
           name="ip"
           th:value="${searchIp}"
           placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.1"
           size="20">
    <button type="submit">–ù–∞–π—Ç–∏</button>
</form>

<hr>

<!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
<div th:if="${searchIp != null and !searchIp.isEmpty()}">

    <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è IP: <span th:text="${searchIp}"></span></h2>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö -->
    <div th:if="${noDataMessage}" style="color: red;">
        <h3 th:text="${noDataMessage}"></h3>
        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–π—Ç–∏ –¥—Ä—É–≥–æ–π IP –∞–¥—Ä–µ—Å.</p>
    </div>

    <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ IP -->
    <div th:if="${ipStats != null and ipStats.totalVisits > 0}">

        <h3>–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <table border="1" cellpadding="5">
            <tr>
                <td><strong>–í—Å–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏–π:</strong></td>
                <td th:text="${ipStats.totalVisits}">0</td>
            </tr>
            <tr>
                <td><strong>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü:</strong></td>
                <td th:text="${ipStats.uniquePages}">0</td>
            </tr>
            <tr>
                <td><strong>–ü–µ—Ä–≤–æ–µ –ø–æ—Å–µ—â–µ–Ω–∏–µ:</strong></td>
                <td th:text="${#temporals.format(ipStats.firstVisit, 'dd.MM.yyyy HH:mm')}">-</td>
            </tr>
            <tr>
                <td><strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ—Å–µ—â–µ–Ω–∏–µ:</strong></td>
                <td th:text="${#temporals.format(ipStats.lastVisit, 'dd.MM.yyyy HH:mm')}">-</td>
            </tr>
            <tr>
                <td><strong>–°—Ç—Ä–∞–Ω–∞:</strong></td>
                <td th:text="${ipStats.country}">Unknown</td>
            </tr>
            <tr>
                <td><strong>–ì–æ—Ä–æ–¥:</strong></td>
                <td th:text="${ipStats.city}">Unknown</td>
            </tr>
            <tr>
                <td><strong>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</strong></td>
                <td>
                    <span th:if="${ipStats.isMobile}">üì± –ú–æ–±–∏–ª—å–Ω–æ–µ</span>
                    <span th:unless="${ipStats.isMobile}">üíª –î–µ—Å–∫—Ç–æ–ø</span>
                </td>
            </tr>
            <tr>
                <td><strong>–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong></td>
                <td th:text="${ipStats.operatingSystem}">Unknown</td>
            </tr>
            <tr>
                <td><strong>–ë—Ä–∞—É–∑–µ—Ä:</strong></td>
                <td th:text="${ipStats.browserName}">Unknown</td>
            </tr>
        </table>

        <hr>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º -->
        <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º</h3>
        <table border="1" cellpadding="5">
            <thead>
            <tr>
                <th>‚Ññ</th>
                <th>–°—Ç—Ä–∞–Ω–∏—Ü–∞</th>
                <th>–ü–æ—Å–µ—â–µ–Ω–∏–π</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="page, pageStat : ${ipStats.pageStats}">
                <td th:text="${pageStat.count}">1</td>
                <td>
                    <code th:text="${page.url}"></code>
                </td>
                <td th:text="${page.visits}">5</td>
            </tr>
            </tbody>
        </table>

        <hr>

        <!-- –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è –ø–æ—Å–µ—â–µ–Ω–∏–π -->
        <h3>–•—Ä–æ–Ω–æ–ª–æ–≥–∏—è –ø–æ—Å–µ—â–µ–Ω–∏–π (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50)</h3>
        <table border="1" cellpadding="5">
            <thead>
            <tr>
                <th>‚Ññ</th>
                <th>–í—Ä–µ–º—è</th>
                <th>–°—Ç—Ä–∞–Ω–∏—Ü–∞</th>
                <th>–û—Ç–∫—É–¥–∞ –ø—Ä–∏—à–µ–ª</th>
                <th>–°–µ—Å—Å–∏—è</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="visit, visitStat : ${timeline}">
                <td th:text="${visitStat.count}">1</td>
                <td th:text="${#temporals.format(visit.visitTime, 'dd.MM.yyyy HH:mm:ss')}">01.08.2025 12:34:56</td>
                <td>
                    <code th:text="${visit.requestedUrl}"></code>
                </td>
                <td>
                            <span th:if="${visit.refererUrl}">
                                <small th:text="${visit.refererUrl}"></small>
                            </span>
                    <span th:unless="${visit.refererUrl}">
                                <em>–ü—Ä—è–º–æ–π –∑–∞—Ö–æ–¥</em>
                            </span>
                </td>
                <td>
                    <small th:text="${visit.sessionId}"></small>
                </td>
            </tr>
            </tbody>
        </table>

        <hr>

        <!-- –í—Å–µ –ø–æ—Å–µ—â–µ–Ω–∏—è (–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫) -->
        <h3>–í—Å–µ –ø–æ—Å–µ—â–µ–Ω–∏—è (–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫)</h3>
        <table border="1" cellpadding="5">
            <thead>
            <tr>
                <th>ID</th>
                <th>–í—Ä–µ–º—è</th>
                <th>–°—Ç—Ä–∞–Ω–∏—Ü–∞</th>
                <th>User-Agent</th>
                <th>–ë–æ—Ç?</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="visit : ${ipVisits}">
                <td th:text="${visit.id}">123</td>
                <td th:text="${#temporals.format(visit.visitTime, 'dd.MM.yyyy HH:mm:ss')}">01.08.2025 12:34:56</td>
                <td>
                    <code th:text="${visit.requestedUrl}"></code>
                </td>
                <td>
                    <small th:text="${visit.userAgent}"></small>
                </td>
                <td>
                    <span th:if="${visit.isBot}" style="color: red;">ü§ñ –î–ê</span>
                    <span th:unless="${visit.isBot}" style="color: green;">üë§ –ù–ï–¢</span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- –û—à–∏–±–∫–∏ -->
<div th:if="${error}" style="color: red; border: 1px solid red; padding: 10px; margin: 10px 0;">
    <h3>–û—à–∏–±–∫–∞</h3>
    <p th:text="${error}">–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞</p>
</div>

<hr>

<!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ -->
<h3>–ü—Ä–∏–º–µ—Ä—ã –ø–æ–∏—Å–∫–∞:</h3>
<ul>
    <li><a href="/analytics/ip?ip=0:0:0:0:0:0:0:1">0:0:0:0:0:0:0:1</a> (localhost IPv6)</li>
    <li><a href="/analytics/ip?ip=127.0.0.1">127.0.0.1</a> (localhost IPv4)</li>
    <li><a href="/analytics/ip?ip=192.168">192.168</a> (–ø–æ–∏—Å–∫ –ø–æ –Ω–∞—á–∞–ª—É IP)</li>
</ul>

<hr>

<p>
    <small>
        <a href="/analytics">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ</a>
    </small>
</p>

</body>
</html>
<!DOCTYPE html>
<html lang="uk" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—Å–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏ - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</title>
</head>
<body>

<h1>–í—Å–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏</h1>

<!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
<p>
    <a href="/analytics">‚Üê –ù–∞–∑–∞–¥ –∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ</a> |
    <a href="/analytics/countries">–°—Ç—Ä–∞–Ω—ã</a> |
    <a href="/analytics/ip">–ü–æ–∏—Å–∫ –ø–æ IP</a> |
    <a href="/analytics/top-ips">–¢–æ–ø IP</a>
</p>

<hr>

<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ -->
<h2>–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π</h2>
<p>
    <strong>–ü–æ–∫–∞–∑–∞–Ω–æ:</strong>
    <span th:text="${#lists.size(visitors)}">50</span> –∑–∞–ø–∏—Å–µ–π
    (—Å—Ç—Ä–∞–Ω–∏—Ü–∞ <span th:text="${currentPage + 1}">1</span> –∏–∑ <span th:text="${totalPages}">10</span>)
    <br>
    <strong>–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π:</strong> <span th:text="${totalElements}">500</span>
</p>

<!-- –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
<p>
    <strong>–ó–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</strong>
    <a th:href="@{/analytics/visitors(page=0, size=25)}"
       th:style="${pageSize == 25} ? 'font-weight: bold; color: blue;' : ''">25</a> |
    <a th:href="@{/analytics/visitors(page=0, size=50)}"
       th:style="${pageSize == 50} ? 'font-weight: bold; color: blue;' : ''">50</a> |
    <a th:href="@{/analytics/visitors(page=0, size=100)}"
       th:style="${pageSize == 100} ? 'font-weight: bold; color: blue;' : ''">100</a>
</p>

<hr>

<!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π -->
<div th:if="${visitors != null and !visitors.isEmpty()}">

    <table border="1" cellpadding="5" width="100%">
        <thead>
        <tr>
            <th>ID</th>
            <th>–í—Ä–µ–º—è</th>
            <th>IP –ê–¥—Ä–µ—Å</th>
            <th>–°—Ç—Ä–∞–Ω–∞</th>
            <th>–ì–æ—Ä–æ–¥</th>
            <th>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</th>
            <th>–û–°</th>
            <th>–ë—Ä–∞—É–∑–µ—Ä</th>
            <th>–°—Ç—Ä–∞–Ω–∏—Ü–∞</th>
            <th>–ë–æ—Ç?</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="visitor : ${visitors}">
            <td th:text="${visitor.id}">123</td>

            <td>
                <strong th:text="${#temporals.format(visitor.visitTime, 'dd.MM.yyyy')}">01.08.2025</strong>
                <br>
                <small th:text="${#temporals.format(visitor.visitTime, 'HH:mm:ss')}">12:34:56</small>
            </td>

            <td>
                <a th:href="@{/analytics/ip(ip=${visitor.ipAddress})}">
                    <code th:text="${visitor.ipAddress}">192.168.1.1</code>
                </a>
            </td>

            <td th:text="${visitor.country ?: 'Unknown'}">Ukraine</td>

            <td th:text="${visitor.city ?: 'Unknown'}">Kyiv</td>

            <td>
                <span th:if="${visitor.isMobile}">üì± Mobile</span>
                <span th:unless="${visitor.isMobile}">üíª Desktop</span>
            </td>

            <td th:text="${visitor.operatingSystem ?: 'Unknown'}">Windows</td>

            <td th:text="${visitor.browserName ?: 'Unknown'}">Chrome</td>

            <td>
                <code th:text="${visitor.requestedUrl}"></code>
            </td>

            <td>
                <span th:if="${visitor.isBot}" style="color: red;">ü§ñ –î–ê</span>
                <span th:unless="${visitor.isBot}" style="color: green;">üë§ –ù–ï–¢</span>
            </td>

            <td>
                <a th:href="@{/analytics/ip(ip=${visitor.ipAddress})}">üìä –î–µ—Ç–∞–ª–∏</a>
            </td>
        </tr>
        </tbody>
    </table>

</div>

<!-- –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö -->
<div th:if="${visitors == null or visitors.isEmpty()}">
    <h3 style="color: orange;">–ù–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π</h3>
    <p>–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è—Ö.</p>
</div>

<hr>

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
<div th:if="${totalPages > 1}">
    <h3>–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º</h3>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ -->
    <p>
        <strong>–°—Ç—Ä–∞–Ω–∏—Ü–∞ <span th:text="${currentPage + 1}">1</span> –∏–∑ <span th:text="${totalPages}">10</span></strong>
        <br>
        –ü–æ–∫–∞–∑–∞–Ω–æ –∑–∞–ø–∏—Å–∏ —Å <span th:text="${currentPage * pageSize + 1}">1</span>
        –ø–æ <span th:text="${currentPage * pageSize + #lists.size(visitors)}">50</span>
        –∏–∑ <span th:text="${totalElements}">500</span> –æ–±—â–∏—Ö
    </p>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ -->
    <p>
        <!-- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <a th:if="${currentPage > 0}"
           th:href="@{/analytics/visitors(page=0, size=${pageSize})}">
            ¬´ –ü–µ—Ä–≤–∞—è
        </a>

        <!-- –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <a th:if="${hasPrevious}"
           th:href="@{/analytics/visitors(page=${prevPage}, size=${pageSize})}">
            ‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è
        </a>

        <!-- –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü -->
        <span th:if="${totalPages <= 10}">
                <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                    <a th:if="${i != currentPage}"
                       th:href="@{/analytics/visitors(page=${i}, size=${pageSize})}"
                       th:text="${i + 1}">1</a>
                    <strong th:if="${i == currentPage}" th:text="${i + 1}">1</strong>
                    <span> </span>
                </span>
            </span>

        <!-- –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü (—Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ –¥–ª—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞) -->
        <span th:if="${totalPages > 10}">
                <span th:each="i : ${#numbers.sequence(startPage, endPage)}">
                    <a th:if="${i != currentPage}"
                       th:href="@{/analytics/visitors(page=${i}, size=${pageSize})}"
                       th:text="${i + 1}">1</a>
                    <strong th:if="${i == currentPage}" th:text="${i + 1}">1</strong>
                    <span> </span>
                </span>

                <span th:if="${endPage < totalPages - 1}">
                    ...
                    <a th:href="@{/analytics/visitors(page=${totalPages - 1}, size=${pageSize})}"
                       th:text="${totalPages}">10</a>
                </span>
            </span>

        <!-- –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <a th:if="${hasNext}"
           th:href="@{/analytics/visitors(page=${nextPage}, size=${pageSize})}">
            –°–ª–µ–¥—É—é—â–∞—è ‚Üí
        </a>

        <!-- –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <a th:if="${currentPage < totalPages - 1}"
           th:href="@{/analytics/visitors(page=${totalPages - 1}, size=${pageSize})}">
            –ü–æ—Å–ª–µ–¥–Ω—è—è ¬ª
        </a>
    </p>

    <!-- –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ -->
    <p>
        <strong>–ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥:</strong>
    <form method="get" action="/analytics/visitors" style="display: inline;">
        <label for="page">–°—Ç—Ä–∞–Ω–∏—Ü–∞:</label>
        <input type="number"
               id="page"
               name="page"
               min="1"
               th:max="${totalPages}"
               th:value="${currentPage + 1}"
               style="width: 60px;">
        <input type="hidden" name="size" th:value="${pageSize}">
        <button type="submit">–ü–µ—Ä–µ–π—Ç–∏</button>
    </form>
    </p>
</div>

<!-- –û—à–∏–±–∫–∏ -->
<div th:if="${error}" style="color: red; border: 1px solid red; padding: 10px; margin: 10px 0;">
    <h3>–û—à–∏–±–∫–∞</h3>
    <p th:text="${error}">–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞</p>
</div>

<hr>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ -->
<div th:if="${visitors != null and !visitors.isEmpty()}">
    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ</h3>
    <table border="1" cellpadding="5">
        <tr>
            <td><strong>–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π:</strong></td>
            <td th:text="${#lists.size(visitors)}">50</td>
        </tr>
        <tr>
            <td><strong>–ú–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤:</strong></td>
            <td th:text="${mobileCount}">15</td>
        </tr>
        <tr>
            <td><strong>–î–µ—Å–∫—Ç–æ–ø–æ–≤:</strong></td>
            <td th:text="${desktopCount}">35</td>
        </tr>
        <tr>
            <td><strong>–ë–æ—Ç–æ–≤:</strong></td>
            <td th:text="${botCount}">2</td>
        </tr>
        <tr>
            <td><strong>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP:</strong></td>
            <td th:text="${uniqueIPCount}">25</td>
        </tr>
    </table>
</div>

<hr>

<p>
    <small>
        <a href="/analytics">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ</a>
    </small>
</p>

</body>
</html>
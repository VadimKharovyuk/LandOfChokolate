<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</title>
</head>
<body>
<h1>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</h1>

<!-- Flash —Å–æ–æ–±—â–µ–Ω–∏—è -->
<div th:if="${errorMessage}" style="color: red; border: 1px solid red; padding: 10px; margin: 10px 0;">
    <span th:text="${errorMessage}"></span>
</div>

<!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div th:if="${statistics != null}" style="margin: 20px 0;">

    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">

        <!-- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ -->
        <div style="background-color: #007bff; color: white; padding: 20px; border-radius: 8px; text-align: center;">
            <h3 style="margin: 0; font-size: 2em;" th:text="${statistics.totalProducts}"></h3>
            <p style="margin: 5px 0 0 0;">–í—Å–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</p>
        </div>

        <!-- –í –Ω–∞–ª–∏—á–∏–∏ -->
        <div style="background-color: #28a745; color: white; padding: 20px; border-radius: 8px; text-align: center;">
            <h3 style="margin: 0; font-size: 2em;" th:text="${statistics.inStockProducts}"></h3>
            <p style="margin: 5px 0 0 0;">–í –Ω–∞–ª–∏—á–∏–∏</p>
        </div>

        <!-- –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è -->
        <div style="background-color: #ffc107; color: black; padding: 20px; border-radius: 8px; text-align: center;">
            <h3 style="margin: 0; font-size: 2em;" th:text="${statistics.lowStockProducts}"></h3>
            <p style="margin: 5px 0 0 0;">–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è</p>
        </div>

        <!-- –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏ -->
        <div style="background-color: #dc3545; color: white; padding: 20px; border-radius: 8px; text-align: center;">
            <h3 style="margin: 0; font-size: 2em;" th:text="${statistics.outOfStockProducts}"></h3>
            <p style="margin: 5px 0 0 0;">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</p>
        </div>

        <!-- –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è -->
        <div style="background-color: #17a2b8; color: white; padding: 20px; border-radius: 8px; text-align: center; grid-column: span 2;">
            <h3 style="margin: 0; font-size: 1.5em;" th:text="${#numbers.formatDecimal(statistics.totalInventoryValue, 0, 2)} + ' —Ä—É–±.'"></h3>
            <p style="margin: 5px 0 0 0;">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è</p>
        </div>
    </div>

    <!-- –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ -->
    <div style="background-color: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
        <h3>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –Ω–∞–ª–∏—á–∏—é:</h3>
        <div style="display: flex; gap: 20px; align-items: center;">

            <!-- –ü—Ä–æ—Å—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ -->
            <div style="flex: 0 0 300px;">
                <div style="display: flex; height: 30px; border-radius: 15px; overflow: hidden; border: 1px solid #ccc;">
                    <!-- –í –Ω–∞–ª–∏—á–∏–∏ -->
                    <div th:if="${statistics.totalProducts > 0}"
                         th:style="'background-color: #28a745; width: ' + ${statistics.inStockProducts * 100 / statistics.totalProducts} + '%;'"></div>
                    <!-- –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è -->
                    <div th:if="${statistics.totalProducts > 0}"
                         th:style="'background-color: #ffc107; width: ' + ${statistics.lowStockProducts * 100 / statistics.totalProducts} + '%;'"></div>
                    <!-- –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏ -->
                    <div th:if="${statistics.totalProducts > 0}"
                         th:style="'background-color: #dc3545; width: ' + ${statistics.outOfStockProducts * 100 / statistics.totalProducts} + '%;'"></div>
                </div>
            </div>

            <!-- –õ–µ–≥–µ–Ω–¥–∞ -->
            <div style="flex: 1;">
                <div style="display: flex; flex-direction: column; gap: 5px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 20px; height: 20px; background-color: #28a745; border-radius: 3px;"></div>
                        <span>–í –Ω–∞–ª–∏—á–∏–∏: <strong th:text="${statistics.inStockProducts}"></strong>
                              (<span th:if="${statistics.totalProducts > 0}" th:text="${#numbers.formatDecimal(statistics.inStockProducts * 100 / statistics.totalProducts, 0, 1)} + '%'"></span>)</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 20px; height: 20px; background-color: #ffc107; border-radius: 3px;"></div>
                        <span>–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è: <strong th:text="${statistics.lowStockProducts}"></strong>
                              (<span th:if="${statistics.totalProducts > 0}" th:text="${#numbers.formatDecimal(statistics.lowStockProducts * 100 / statistics.totalProducts, 0, 1)} + '%'"></span>)</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 20px; height: 20px; background-color: #dc3545; border-radius: 3px;"></div>
                        <span>–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏: <strong th:text="${statistics.outOfStockProducts}"></strong>
                              (<span th:if="${statistics.totalProducts > 0}" th:text="${#numbers.formatDecimal(statistics.outOfStockProducts * 100 / statistics.totalProducts, 0, 1)} + '%'"></span>)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –¢–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º –æ—Å—Ç–∞—Ç–∫–æ–º -->
<div th:if="${lowStockProducts != null and !lowStockProducts.isEmpty()}" style="margin: 30px 0;">
    <h2 style="color: #ffc107;">‚ö†Ô∏è –¢–æ–≤–∞—Ä—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è (–º–µ–Ω–µ–µ 10 —à—Ç—É–∫)</h2>
    <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px;">
        <table border="1" style="border-collapse: collapse; width: 100%;">
            <thead style="background-color: #ffc107;">
            <tr>
                <th style="padding: 8px; text-align: left;">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th style="padding: 8px; text-align: left;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th style="padding: 8px; text-align: left;">–ë—Ä–µ–Ω–¥</th>
                <th style="padding: 8px; text-align: center;">–û—Å—Ç–∞—Ç–æ–∫</th>
                <th style="padding: 8px; text-align: right;">–¶–µ–Ω–∞</th>
                <th style="padding: 8px; text-align: center;">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="product : ${lowStockProducts}">
                <td style="padding: 8px;" th:text="${product.name}"></td>
                <td style="padding: 8px;" th:text="${product.categoryName}"></td>
                <td style="padding: 8px;" th:text="${product.brandName}"></td>
                <td style="padding: 8px; text-align: center; font-weight: bold; color: orange;" th:text="${product.stockQuantity}"></td>
                <td style="padding: 8px; text-align: right;" th:text="${#numbers.formatDecimal(product.price, 0, 2)} + ' —Ä—É–±.'"></td>
                <td style="padding: 8px; text-align: center;">
                    <a th:href="@{'/admin/product/view/' + ${product.id}}"
                       style="color: #007bff; text-decoration: none; font-size: 12px;">
                        –ü—Ä–æ—Å–º–æ—Ç—Ä
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- –¢–æ–≤–∞—Ä—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –Ω–∞ —Å–∫–ª–∞–¥–µ -->
<div th:if="${outOfStockProducts != null and !outOfStockProducts.isEmpty()}" style="margin: 30px 0;">
    <h2 style="color: #dc3545;">‚ùå –¢–æ–≤–∞—Ä—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–∞ —Å–∫–ª–∞–¥–µ</h2>
    <div style="background-color: #f8d7da; border: 1px solid #f5c6cb; padding: 15px; border-radius: 8px;">
        <table border="1" style="border-collapse: collapse; width: 100%;">
            <thead style="background-color: #dc3545; color: white;">
            <tr>
                <th style="padding: 8px; text-align: left;">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th style="padding: 8px; text-align: left;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th style="padding: 8px; text-align: left;">–ë—Ä–µ–Ω–¥</th>
                <th style="padding: 8px; text-align: right;">–¶–µ–Ω–∞</th>
                <th style="padding: 8px; text-align: center;">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="product : ${outOfStockProducts}">
                <td style="padding: 8px;" th:text="${product.name}"></td>
                <td style="padding: 8px;" th:text="${product.categoryName}"></td>
                <td style="padding: 8px;" th:text="${product.brandName}"></td>
                <td style="padding: 8px; text-align: right;" th:text="${#numbers.formatDecimal(product.price, 0, 2)} + ' —Ä—É–±.'"></td>
                <td style="padding: 8px; text-align: center;">
                    <a th:href="@{'/admin/product/view/' + ${product.id}}"
                       style="color: #007bff; text-decoration: none; font-size: 12px;">
                        –ü—Ä–æ—Å–º–æ—Ç—Ä
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div style="margin: 30px 0; padding: 20px; background-color: #e9ecef; border-radius: 8px;">
    <h3>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:</h3>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <a th:href="@{/admin/product}"
           style="padding: 10px 20px; background-color: #28a745; color: white; text-decoration: none; border-radius: 5px;">
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç
        </a>
        <a th:href="@{/admin/product/list}"
           style="padding: 10px 20px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px;">
            üìã –í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã
        </a>
        <a th:href="@{/admin/product/list(status='low-stock')}"
           style="padding: 10px 20px; background-color: #ffc107; color: black; text-decoration: none; border-radius: 5px;">
            ‚ö†Ô∏è –ó–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–µ—Å—è —Ç–æ–≤–∞—Ä—ã
        </a>
        <a th:href="@{/admin/product/list(status='out-of-stock')}"
           style="padding: 10px 20px; background-color: #dc3545; color: white; text-decoration: none; border-radius: 5px;">
            ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã
        </a>
        <a th:href="@{/admin/category/list}"
           style="padding: 10px 20px; background-color: #6c757d; color: white; text-decoration: none; border-radius: 5px;">
            üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        </a>
        <a th:href="@{/admin/brand/list}"
           style="padding: 10px 20px; background-color: #6c757d; color: white; text-decoration: none; border-radius: 5px;">
            üè∑Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–∞–º–∏
        </a>
    </div>
</div>

<!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
<div style="margin: 30px 0; padding: 20px; background-color: #cff4fc; border: 1px solid #b6effb; border-radius: 8px;">
    <h3 style="color: #055160;">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h3>
    <ul style="margin: 10px 0; padding-left: 20px;">
        <li th:if="${statistics != null and statistics.lowStockProducts > 0}" style="margin: 5px 0;">
            –£ –≤–∞—Å <strong th:text="${statistics.lowStockProducts}"></strong> —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø–æ–ø–æ–ª–Ω–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏.
        </li>
        <li th:if="${statistics != null and statistics.outOfStockProducts > 0}" style="margin: 5px 0;">
            <strong th:text="${statistics.outOfStockProducts}"></strong> —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–∞ —Å–∫–ª–∞–¥–µ. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—Ä–æ—á–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ.
        </li>
        <li th:if="${statistics != null and statistics.totalProducts == 0}" style="margin: 5px 0;">
            –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ. –ù–∞—á–Ω–∏—Ç–µ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.
        </li>
        <li th:if="${statistics != null and statistics.totalProducts > 0 and statistics.inStockProducts == statistics.totalProducts}" style="margin: 5px 0; color: green;">
            –û—Ç–ª–∏—á–Ω–æ! –í—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –Ω–∞–ª–∏—á–∏–∏.
        </li>
    </ul>
</div>

<!-- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
<div style="margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px; background-color: #f8f9fa; padding: 10px; border-radius: 8px;">
    <h4>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>
    <div style="font-size: 12px; color: #666;">
        <p><strong>–í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞:</strong> <span th:text="${#temporals.format(#temporals.createNow(), 'dd.MM.yyyy HH:mm:ss')}"></span></p>
        <p th:if="${statistics != null}"><strong>–í—Å–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –±–∞–∑–µ:</strong> <span th:text="${statistics.totalProducts}"></span></p>
        <p th:if="${statistics != null}"><strong>–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–∫–ª–∞–¥–∞:</strong> <span th:text="${#numbers.formatDecimal(statistics.totalInventoryValue, 0, 2)} + ' —Ä—É–±.'"></span></p>
        <p th:if="${statistics != null}"><strong>–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞:</strong>
            <span th:if="${statistics.totalProducts > 0}" th:text="${#numbers.formatDecimal(statistics.totalInventoryValue / statistics.totalProducts, 0, 2)} + ' —Ä—É–±.'"></span>
            <span th:if="${statistics.totalProducts == 0}">0 —Ä—É–±.</span>
        </p>
    </div>
</div>

<!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö -->
<div th:if="${statistics == null}" style="padding: 20px; background-color: #f8f9fa; border: 1px solid #dee2e6; margin: 20px 0; text-align: center;">
    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</h3>
    <p>–í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –µ—â–µ –Ω–µ—Ç –ø—Ä–æ–¥—É–∫—Ç–æ–≤.</p>
    <a th:href="@{/admin/product}" style="padding: 10px 20px; background-color: #007bff; color: white; text-decoration: none; display: inline-block;">
        –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç
    </a>
</div>

<!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
<div style="margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px;">
    <h3>–ù–∞–≤–∏–≥–∞—Ü–∏—è:</h3>
    <ul>
        <li><a th:href="@{/admin/product/list}">–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤</a></li>
        <li><a th:href="@{/admin/product}">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç</a></li>
        <li><a th:href="@{/admin/product/statistics}">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</a></li>
        <li><a th:href="@{/admin/category/list}">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</a></li>
        <li><a th:href="@{/admin/brand/list}">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–∞–º–∏</a></li>
    </ul>
</div>
</body>
</html>
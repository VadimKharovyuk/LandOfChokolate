<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Редагування продукту</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body class="bg-light">

<div class="container py-4">
  <h1><i class="bi bi-pencil-square me-2"></i>Редагування продукту</h1>

  <!-- Flash сообщения -->
  <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show" role="alert">
    <i class="bi bi-check-circle me-2"></i>
    <span th:text="${successMessage}"></span>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>

  <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show" role="alert">
    <i class="bi bi-exclamation-triangle me-2"></i>
    <span th:text="${errorMessage}"></span>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>

  <!-- Форма редактирования -->
  <form th:action="@{'/admin/product/edit/' + ${productId}}"
        th:object="${product}"
        method="post">

    <div class="row g-4">
      <!-- Основная информация -->
      <div class="col-lg-6">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>Основна інформація</h5>
          </div>
          <div class="card-body">
            <!-- Название -->
            <div class="mb-3">
              <label for="name" class="form-label fw-bold">
                <i class="bi bi-tag me-1"></i>Назва продукту *
              </label>
              <input type="text" id="name" th:field="*{name}"
                     class="form-control" th:classappend="${#fields.hasErrors('name')} ? 'is-invalid' : ''"
                     placeholder="Введіть назву продукту">
              <div th:if="${#fields.hasErrors('name')}" class="invalid-feedback">
                <span th:each="error : ${#fields.errors('name')}" th:text="${error}"></span>
              </div>
            </div>

            <!-- Цена -->
            <div class="mb-3">
              <label for="price" class="form-label fw-bold">
                <i class="bi bi-currency-exchange me-1"></i>Ціна *
              </label>
              <div class="input-group">
                <input type="number" id="price" th:field="*{price}" step="0.01" min="0.01"
                       class="form-control" th:classappend="${#fields.hasErrors('price')} ? 'is-invalid' : ''"
                       placeholder="0.00">
                <span class="input-group-text">₴</span>
              </div>
              <div th:if="${#fields.hasErrors('price')}" class="invalid-feedback">
                <span th:each="error : ${#fields.errors('price')}" th:text="${error}"></span>
              </div>
            </div>

            <!-- Единица измерения -->
            <div class="mb-3">
              <label for="priceUnit" class="form-label fw-bold">
                <i class="bi bi-rulers me-1"></i>Одиниця вимірювання *
              </label>
              <select id="priceUnit" th:field="*{priceUnit}"
                      class="form-select" th:classappend="${#fields.hasErrors('priceUnit')} ? 'is-invalid' : ''">
                <option th:each="unit : ${priceUnits}" th:value="${unit}" th:text="${unit.label}"></option>
              </select>
              <div th:if="${#fields.hasErrors('priceUnit')}" class="invalid-feedback">
                <span th:each="error : ${#fields.errors('priceUnit')}" th:text="${error}"></span>
              </div>
            </div>

            <!-- Количество -->
            <div class="mb-3">
              <label for="stockQuantity" class="form-label fw-bold">
                <i class="bi bi-boxes me-1"></i>Кількість на складі *
              </label>
              <input type="number" id="stockQuantity" th:field="*{stockQuantity}" min="0"
                     class="form-control" th:classappend="${#fields.hasErrors('stockQuantity')} ? 'is-invalid' : ''"
                     placeholder="0">
              <div th:if="${#fields.hasErrors('stockQuantity')}" class="invalid-feedback">
                <span th:each="error : ${#fields.errors('stockQuantity')}" th:text="${error}"></span>
              </div>
            </div>

            <!-- Рекомендация -->
            <div class="mb-3">
              <div class="form-check form-switch">
                <input type="checkbox" id="isRecommendation" th:field="*{isRecommendation}"
                       class="form-check-input" role="switch">
                <label for="isRecommendation" class="form-check-label fw-bold text-primary">
                  <i class="bi bi-star me-1"></i>Рекомендований товар
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Категории и бренды -->
      <div class="col-lg-6">
        <div class="card">
          <div class="card-header bg-success text-white">
            <h5 class="mb-0"><i class="bi bi-collection me-2"></i>Категорії та бренди</h5>
          </div>
          <div class="card-body">
            <!-- Категория -->
            <div class="mb-3">
              <label for="categoryId" class="form-label fw-bold">
                <i class="bi bi-folder me-1"></i>Категорія *
              </label>
              <select id="categoryId" th:field="*{categoryId}"
                      class="form-select" th:classappend="${#fields.hasErrors('categoryId')} ? 'is-invalid' : ''">
                <option value="">Оберіть категорію</option>
                <option th:each="category : ${categories}" th:value="${category.id}" th:text="${category.name}"></option>
              </select>
              <div th:if="${#fields.hasErrors('categoryId')}" class="invalid-feedback">
                <span th:each="error : ${#fields.errors('categoryId')}" th:text="${error}"></span>
              </div>
            </div>

            <!-- Бренд -->
            <div class="mb-3">
              <label for="brandId" class="form-label fw-bold">
                <i class="bi bi-award me-1"></i>Бренд *
              </label>
              <select id="brandId" th:field="*{brandId}"
                      class="form-select" th:classappend="${#fields.hasErrors('brandId')} ? 'is-invalid' : ''">
                <option value="">Оберіть бренд</option>
                <option th:each="brand : ${brands}" th:value="${brand.id}" th:text="${brand.name}"></option>
              </select>
              <div th:if="${#fields.hasErrors('brandId')}" class="invalid-feedback">
                <span th:each="error : ${#fields.errors('brandId')}" th:text="${error}"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SEO секция -->
    <div class="row mt-4">
      <div class="col-12">
        <div class="card border-warning">
          <div class="card-header bg-warning text-dark">
            <h5 class="mb-0"><i class="bi bi-search me-2"></i>SEO оптимізація</h5>
          </div>
          <div class="card-body">
            <div class="row g-3">
              <!-- Meta Title -->
              <div class="col-md-6">
                <label for="metaTitle" class="form-label fw-bold">
                  <i class="bi bi-card-heading me-1"></i>SEO заголовок
                </label>
                <input type="text" id="metaTitle" th:field="*{metaTitle}"
                       class="form-control" th:classappend="${#fields.hasErrors('metaTitle')} ? 'is-invalid' : ''"
                       maxlength="60" placeholder="SEO заголовок для пошукових систем">
                <div class="form-text">Максимум 60 символів</div>
                <div th:if="${#fields.hasErrors('metaTitle')}" class="invalid-feedback">
                  <span th:each="error : ${#fields.errors('metaTitle')}" th:text="${error}"></span>
                </div>
              </div>

              <!-- Meta Description -->
              <div class="col-md-6">
                <label for="metaDescription" class="form-label fw-bold">
                  <i class="bi bi-card-text me-1"></i>SEO опис
                </label>
                <textarea id="metaDescription" th:field="*{metaDescription}"
                          class="form-control" th:classappend="${#fields.hasErrors('metaDescription')} ? 'is-invalid' : ''"
                          rows="3" maxlength="160"
                          placeholder="Короткий опис для пошукових систем"></textarea>
                <div class="form-text">Максимум 160 символів</div>
                <div th:if="${#fields.hasErrors('metaDescription')}" class="invalid-feedback">
                  <span th:each="error : ${#fields.errors('metaDescription')}" th:text="${error}"></span>
                </div>
              </div>

              <!-- Описание -->
              <div class="col-12">
                <label for="description" class="form-label fw-bold">
                  <i class="bi bi-file-text me-1"></i>Повний опис товару
                </label>
                <textarea id="description" th:field="*{description}"
                          class="form-control" th:classappend="${#fields.hasErrors('description')} ? 'is-invalid' : ''"
                          rows="5" maxlength="1000"
                          placeholder="Детальний опис товару для покупців"></textarea>
                <div class="form-text">Максимум 1000 символів</div>
                <div th:if="${#fields.hasErrors('description')}" class="invalid-feedback">
                  <span th:each="error : ${#fields.errors('description')}" th:text="${error}"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Кнопки -->
    <div class="row mt-4">
      <div class="col-12">
        <div class="card">
          <div class="card-body">
            <div class="d-flex gap-2">
              <button type="submit" class="btn btn-primary btn-lg">
                <i class="bi bi-check-lg me-2"></i>Оновити продукт
              </button>
              <a th:href="@{/admin/product/list}" class="btn btn-secondary btn-lg">
                <i class="bi bi-arrow-left me-2"></i>Скасувати
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

  </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</title>
</head>
<body>
<h1>–°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</h1>
<p style="font-size: 14px; color: #666;" th:text="${filterDescription}"></p>

<!-- Flash —Å–æ–æ–±—â–µ–Ω–∏—è -->
<div th:if="${successMessage}" style="color: green; border: 1px solid green; padding: 10px; margin: 10px 0;">
    <span th:text="${successMessage}"></span>
</div>

<div th:if="${errorMessage}" style="color: red; border: 1px solid red; padding: 10px; margin: 10px 0;">
    <span th:text="${errorMessage}"></span>
</div>

<!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
<div style="margin: 20px 0; padding: 15px; background-color: #f8f9fa; border: 1px solid #dee2e6;">

    <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ -->
    <div style="margin-bottom: 15px;">
        <a th:href="@{/admin/product}" style="padding: 10px 20px; background-color: #28a745; color: white; text-decoration: none; display: inline-block;">
            + –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç
        </a>
        <a th:href="@{/admin/product/statistics}" style="margin-left: 10px; padding: 10px 20px; background-color: #17a2b8; color: white; text-decoration: none; display: inline-block;">
            üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        </a>
    </div>

    <!-- –§–∏–ª—å—Ç—Ä—ã -->
    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: end;">

        <!-- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é -->
        <div>
            <label for="search">–ü–æ–∏—Å–∫:</label><br>
            <form th:action="@{/admin/product/list}" method="get" style="display: inline-flex;">
                <input type="text" id="search" name="search" th:value="${searchTerm}"
                       placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞..."
                       style="padding: 8px; width: 200px;">
                <button type="submit" style="padding: 8px 15px; background-color: #007bff; color: white; border: none; cursor: pointer;">
                    –ù–∞–π—Ç–∏
                </button>
            </form>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
        <div>
            <label for="categoryFilter">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label><br>
            <form th:action="@{/admin/product/list}" method="get" style="display: inline;">
                <select id="categoryFilter" name="category" onchange="this.form.submit()" style="padding: 8px;">
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    <option th:each="category : ${filterCategories}"
                            th:value="${category.id}"
                            th:text="${category.name}"
                            th:selected="${category.id == selectedCategory}"></option>
                </select>
            </form>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä –ø–æ –±—Ä–µ–Ω–¥—É -->
        <div>
            <label for="brandFilter">–ë—Ä–µ–Ω–¥:</label><br>
            <form th:action="@{/admin/product/list}" method="get" style="display: inline;">
                <select id="brandFilter" name="brand" onchange="this.form.submit()" style="padding: 8px;">
                    <option value="">–í—Å–µ –±—Ä–µ–Ω–¥—ã</option>
                    <option th:each="brand : ${filterBrands}"
                            th:value="${brand.id}"
                            th:text="${brand.name}"
                            th:selected="${brand.id == selectedBrand}"></option>
                </select>
            </form>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É –Ω–∞–ª–∏—á–∏—è -->
        <div>
            <label for="statusFilter">–ù–∞–ª–∏—á–∏–µ:</label><br>
            <form th:action="@{/admin/product/list}" method="get" style="display: inline;">
                <select id="statusFilter" name="status" onchange="this.form.submit()" style="padding: 8px;">
                    <option value="">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</option>
                    <option value="in-stock" th:selected="${selectedStatus == 'in-stock'}">–í –Ω–∞–ª–∏—á–∏–∏</option>
                    <option value="low-stock" th:selected="${selectedStatus == 'low-stock'}">–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è</option>
                    <option value="out-of-stock" th:selected="${selectedStatus == 'out-of-stock'}">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</option>
                </select>
            </form>
        </div>

        <!-- –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
        <div>
            <a th:href="@{/admin/product/list}" style="padding: 8px 15px; background-color: #6c757d; color: white; text-decoration: none; display: inline-block;">
                –°–±—Ä–æ—Å–∏—Ç—å
            </a>
        </div>
    </div>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ -->
<div th:if="${products != null and !products.isEmpty()}">
    <h2>–ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤: <span th:text="${products.size()}"></span></h2>

    <table border="1" style="border-collapse: collapse; width: 100%; margin: 20px 0;">
        <thead style="background-color: #f8f9fa;">
        <tr>
            <th style="padding: 10px; text-align: left;">ID</th>
            <th style="padding: 10px; text-align: left;">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>
            <th style="padding: 10px; text-align: left;">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th style="padding: 10px; text-align: left;">–¶–µ–Ω–∞</th>
            <th style="padding: 10px; text-align: left;">–û—Å—Ç–∞—Ç–æ–∫</th>
            <th style="padding: 10px; text-align: left;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
            <th style="padding: 10px; text-align: left;">–ë—Ä–µ–Ω–¥</th>
            <th style="padding: 10px; text-align: left;">–°—Ç–∞—Ç—É—Å</th>
            <th style="padding: 10px; text-align: center;">–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="product : ${products}">
            <td style="padding: 10px;" th:text="${product.id}"></td>

            <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
            <td style="padding: 10px; text-align: center;">
                <div th:if="${product.imageUrl != null and !product.imageUrl.isEmpty()}">
                    <img th:src="${product.imageUrl}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞"
                         style="max-width: 50px; max-height: 50px; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                <div th:if="${product.imageUrl == null or product.imageUrl.isEmpty()}"
                     style="color: #6c757d; font-style: italic; font-size: 12px;">
                    –ù–µ—Ç —Ñ–æ—Ç–æ
                </div>
            </td>

            <!-- –ù–∞–∑–≤–∞–Ω–∏–µ (—Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä) -->
            <td style="padding: 10px;">
                <a th:href="@{'/admin/product/view/' + ${product.id}}"
                   style="text-decoration: none; color: #007bff; font-weight: bold;"
                   th:text="${product.name}"></a>
            </td>

            <!-- –¶–µ–Ω–∞ -->
            <td style="padding: 10px; text-align: right;">
                <span th:text="${#numbers.formatDecimal(product.price, 0, 2)} + ' –≥—Ä–Ω.'"></span>
            </td>

            <!-- –û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ —Å–∫–ª–∞–¥–µ -->
            <td style="padding: 10px; text-align: center;">
                <span th:text="${product.stockQuantity}"
                      th:class="${product.stockQuantity == 0 ? 'out-of-stock' : (product.lowStock ? 'low-stock' : 'in-stock')}"
                      th:style="${product.stockQuantity == 0 ? 'color: red; font-weight: bold;' : (product.lowStock ? 'color: orange; font-weight: bold;' : 'color: green;')}"></span>
            </td>

            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è -->
            <td style="padding: 10px;" th:text="${product.categoryName}"></td>

            <!-- –ë—Ä–µ–Ω–¥ -->
            <td style="padding: 10px;" th:text="${product.brandName}"></td>

            <!-- –°—Ç–∞—Ç—É—Å -->
            <td style="padding: 10px; text-align: center;">
                <span th:if="${!product.inStock}"
                      style="padding: 3px 8px; background-color: #dc3545; color: white; border-radius: 3px; font-size: 11px;">
                    –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏
                </span>
                <span th:if="${product.inStock and product.lowStock}"
                      style="padding: 3px 8px; background-color: #ffc107; color: black; border-radius: 3px; font-size: 11px;">
                    –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è
                </span>
                <span th:if="${product.inStock and !product.lowStock}"
                      style="padding: 3px 8px; background-color: #28a745; color: white; border-radius: 3px; font-size: 11px;">
                    –í –Ω–∞–ª–∏—á–∏–∏
                </span>
            </td>

            <!-- –î–µ–π—Å—Ç–≤–∏—è -->
            <td style="padding: 10px; text-align: center;">
                <a th:href="@{'/admin/product/view/' + ${product.id}}"
                   style="color: #17a2b8; text-decoration: none; margin-right: 5px; font-size: 12px;">
                    –ü—Ä–æ—Å–º–æ—Ç—Ä
                </a>
                <a th:href="@{'/admin/product/edit/' + ${product.id}}"
                   style="color: #007bff; text-decoration: none; margin-right: 5px; font-size: 12px;">
                    –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                </a>
                <a th:href="@{'/admin/product/delete/' + ${product.id}}"
                   style="color: #dc3545; text-decoration: none; font-size: 12px;"
                   onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–¥—É–∫—Ç?')">
                    –£–¥–∞–ª–∏—Ç—å
                </a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<!-- –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–≥–¥–∞ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç -->
<div th:if="${products == null or products.isEmpty()}" style="padding: 20px; background-color: #f8f9fa; border: 1px solid #dee2e6; margin: 20px 0;">
    <h3>–ü—Ä–æ–¥—É–∫—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
    <p th:if="${searchTerm != null and !searchTerm.isEmpty()}">
        –ü–æ –∑–∞–ø—Ä–æ—Å—É "<span th:text="${searchTerm}"></span>" –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.
        <a th:href="@{/admin/product/list}">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã</a>
    </p>
    <p th:if="${searchTerm == null or searchTerm.isEmpty()}">
        –ü–æ–∫–∞ —á—Ç–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–æ.
    </p>

    <a th:href="@{/admin/product}" style="padding: 10px 20px; background-color: #007bff; color: white; text-decoration: none; display: inline-block;">
        –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç
    </a>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (–∫–Ω–æ–ø–∫–∏) -->
<div style="margin: 20px 0; padding: 15px; background-color: #e9ecef; border-radius: 5px;">
    <h4>–ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:</h4>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <a th:href="@{/admin/product/list}"
           style="padding: 8px 15px; background-color: #007bff; color: white; text-decoration: none; border-radius: 3px; font-size: 12px;">
            –í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã
        </a>
        <a th:href="@{/admin/product/list(status='in-stock')}"
           style="padding: 8px 15px; background-color: #28a745; color: white; text-decoration: none; border-radius: 3px; font-size: 12px;">
            –í –Ω–∞–ª–∏—á–∏–∏
        </a>
        <a th:href="@{/admin/product/list(status='low-stock')}"
           style="padding: 8px 15px; background-color: #ffc107; color: black; text-decoration: none; border-radius: 3px; font-size: 12px;">
            –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è
        </a>
        <a th:href="@{/admin/product/list(status='out-of-stock')}"
           style="padding: 8px 15px; background-color: #dc3545; color: white; text-decoration: none; border-radius: 3px; font-size: 12px;">
            –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏
        </a>
    </div>
</div>

<!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
<div style="margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px;">
    <h3>–ù–∞–≤–∏–≥–∞—Ü–∏—è:</h3>
    <ul>
        <li><a th:href="@{/admin/product}">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç</a></li>
        <li><a th:href="@{/admin/product/list}">–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</a></li>
        <li><a th:href="@{/admin/product/statistics}">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</a></li>
        <li><a th:href="@{/admin/category/list}">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</a></li>
        <li><a th:href="@{/admin/brand/list}">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–∞–º–∏</a></li>
    </ul>
</div>

<!-- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
<div style="margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px; background-color: #f8f9fa; padding: 10px;">
    <h4>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>
    <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤: <span th:text="${products != null ? products.size() : 'null'}"></span></p>
    <p>–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: <span th:text="${searchTerm != null ? searchTerm : '–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}"></span></p>
    <p>–í—ã–±—Ä–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: <span th:text="${selectedCategory != null ? selectedCategory : '–≤—Å–µ'}"></span></p>
    <p>–í—ã–±—Ä–∞–Ω–Ω—ã–π –±—Ä–µ–Ω–¥: <span th:text="${selectedBrand != null ? selectedBrand : '–≤—Å–µ'}"></span></p>
    <p>–°—Ç–∞—Ç—É—Å —Ñ–∏–ª—å—Ç—Ä: <span th:text="${selectedStatus != null ? selectedStatus : '–≤—Å–µ'}"></span></p>
    <p>–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: <span th:text="${#temporals.format(#temporals.createNow(), 'dd.MM.yyyy HH:mm:ss')}"></span></p>
</div>
</body>
</html>